#!/usr/bin/env ruby

require 'traveller_rpg'
require 'traveller_rpg/careers'
require 'traveller_rpg/generator'
require 'traveller_rpg/career_path'

char = TravellerRPG::Generator.character
puts
puts char.report(desc: :long, stuff: false, credits: false)
puts

path = TravellerRPG::CareerPath.new(char)

careers = %w{Scout Agent}

loop {
  careers = careers.select { |c| path.eligible? c }
  if careers.empty?
    puts "No eligible careers available!"
    break
  end
  career = TravellerRPG.choose("Choose a career", *careers)
  career = TravellerRPG.career_class(career).new(char)
  path.run(career)

  puts "\n"
  path.careers.each { |c|
    puts "\n" * 1
    puts c.report
    puts "\n" * 1
  }
  puts "\n"
  puts char.report
  puts "\n" * 2

  break if TravellerRPG.choose("Exit career mode?", :yes, :no) == :yes
}

puts "DONE"
